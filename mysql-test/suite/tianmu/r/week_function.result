#
# WEEK() function
# Author: syw
#
DROP DATABASE IF EXISTS week_function;
CREATE DATABASE week_function;
USE week_function;
CREATE TABLE t1
(
t1_DATE DATE,
t1_TIMESTAMP TIMESTAMP,
t1_DATETIME DATETIME
)ENGINE=tianmu;
INSERT INTO t1 VALUES('1987-01-01', '1997-11-21 01:00:50', '2087-12-21 01:08:59');
INSERT INTO t1 VALUES('2991-10-13', '1972-11-22 11:19:52', '2000-01-01 05:28:37');
SELECT WEEK('2020-10-12') FROM t1 LIMIT 1;
WEEK('2020-10-12')
41
SELECT WEEK('2020-05-22') FROM t1 LIMIT 1;
WEEK('2020-05-22')
20
SELECT WEEK('2020-02-13 12:13:14') FROM t1 LIMIT 1;
WEEK('2020-02-13 12:13:14')
6
SELECT WEEK('12:13:14') FROM t1 LIMIT 1;
WEEK('12:13:14')
NULL
Warnings:
Warning	1292	Incorrect datetime value: '12:13:14'
SELECT t1_DATE, WEEK(t1_DATE) FROM t1 ORDER BY 1;
t1_DATE	WEEK(t1_DATE)
1987-01-01	0
2991-10-13	41
SELECT t1_DATE, WEEK(t1_DATE, 0) FROM t1 ORDER BY 1;
t1_DATE	WEEK(t1_DATE, 0)
1987-01-01	0
2991-10-13	41
SELECT t1_DATE, WEEK(t1_DATE, 1) FROM t1 ORDER BY 1;
t1_DATE	WEEK(t1_DATE, 1)
1987-01-01	1
2991-10-13	41
SELECT t1_DATE, WEEK(t1_DATE, 2) FROM t1 ORDER BY 1;
t1_DATE	WEEK(t1_DATE, 2)
1987-01-01	52
2991-10-13	41
SELECT t1_DATE, WEEK(t1_DATE, 3) FROM t1 ORDER BY 1;
t1_DATE	WEEK(t1_DATE, 3)
1987-01-01	1
2991-10-13	41
SELECT t1_DATE, WEEK(t1_DATE, 4) FROM t1 ORDER BY 1;
t1_DATE	WEEK(t1_DATE, 4)
1987-01-01	0
2991-10-13	41
SELECT t1_DATE, WEEK(t1_DATE, 5) FROM t1 ORDER BY 1;
t1_DATE	WEEK(t1_DATE, 5)
1987-01-01	0
2991-10-13	41
SELECT t1_DATE, WEEK(t1_DATE, 6) FROM t1 ORDER BY 1;
t1_DATE	WEEK(t1_DATE, 6)
1987-01-01	53
2991-10-13	41
SELECT t1_DATE, WEEK(t1_DATE, 7) FROM t1 ORDER BY 1;
t1_DATE	WEEK(t1_DATE, 7)
1987-01-01	52
2991-10-13	41
SELECT t1_DATETIME, WEEK(t1_DATETIME) FROM t1 ORDER BY 1;
t1_DATETIME	WEEK(t1_DATETIME)
2000-01-01 05:28:37	0
2087-12-21 01:08:59	51
SELECT t1_DATETIME, WEEK(t1_DATETIME, 0) FROM t1 ORDER BY 1;
t1_DATETIME	WEEK(t1_DATETIME, 0)
2000-01-01 05:28:37	0
2087-12-21 01:08:59	51
SELECT t1_DATETIME, WEEK(t1_DATETIME, 1) FROM t1 ORDER BY 1;
t1_DATETIME	WEEK(t1_DATETIME, 1)
2000-01-01 05:28:37	0
2087-12-21 01:08:59	51
SELECT t1_DATETIME, WEEK(t1_DATETIME, 2) FROM t1 ORDER BY 1;
t1_DATETIME	WEEK(t1_DATETIME, 2)
2000-01-01 05:28:37	52
2087-12-21 01:08:59	51
SELECT t1_DATETIME, WEEK(t1_DATETIME, 3) FROM t1 ORDER BY 1;
t1_DATETIME	WEEK(t1_DATETIME, 3)
2000-01-01 05:28:37	52
2087-12-21 01:08:59	51
SELECT t1_DATETIME, WEEK(t1_DATETIME, 4) FROM t1 ORDER BY 1;
t1_DATETIME	WEEK(t1_DATETIME, 4)
2000-01-01 05:28:37	0
2087-12-21 01:08:59	52
SELECT t1_DATETIME, WEEK(t1_DATETIME, 5) FROM t1 ORDER BY 1;
t1_DATETIME	WEEK(t1_DATETIME, 5)
2000-01-01 05:28:37	0
2087-12-21 01:08:59	50
SELECT t1_DATETIME, WEEK(t1_DATETIME, 6) FROM t1 ORDER BY 1;
t1_DATETIME	WEEK(t1_DATETIME, 6)
2000-01-01 05:28:37	52
2087-12-21 01:08:59	52
SELECT t1_DATETIME, WEEK(t1_DATETIME, 7) FROM t1 ORDER BY 1;
t1_DATETIME	WEEK(t1_DATETIME, 7)
2000-01-01 05:28:37	52
2087-12-21 01:08:59	50
SELECT t1_TIMESTAMP, WEEK(t1_TIMESTAMP) FROM t1 ORDER BY 1;
t1_TIMESTAMP	WEEK(t1_TIMESTAMP)
1972-11-22 11:19:52	47
1997-11-21 01:00:50	46
SELECT t1_TIMESTAMP, WEEK(t1_TIMESTAMP, 0) FROM t1 ORDER BY 1;
t1_TIMESTAMP	WEEK(t1_TIMESTAMP, 0)
1972-11-22 11:19:52	47
1997-11-21 01:00:50	46
SELECT t1_TIMESTAMP, WEEK(t1_TIMESTAMP, 1) FROM t1 ORDER BY 1;
t1_TIMESTAMP	WEEK(t1_TIMESTAMP, 1)
1972-11-22 11:19:52	47
1997-11-21 01:00:50	47
SELECT t1_TIMESTAMP, WEEK(t1_TIMESTAMP, 2) FROM t1 ORDER BY 1;
t1_TIMESTAMP	WEEK(t1_TIMESTAMP, 2)
1972-11-22 11:19:52	47
1997-11-21 01:00:50	46
SELECT t1_TIMESTAMP, WEEK(t1_TIMESTAMP, 3) FROM t1 ORDER BY 1;
t1_TIMESTAMP	WEEK(t1_TIMESTAMP, 3)
1972-11-22 11:19:52	47
1997-11-21 01:00:50	47
SELECT t1_TIMESTAMP, WEEK(t1_TIMESTAMP, 4) FROM t1 ORDER BY 1;
t1_TIMESTAMP	WEEK(t1_TIMESTAMP, 4)
1972-11-22 11:19:52	47
1997-11-21 01:00:50	47
SELECT t1_TIMESTAMP, WEEK(t1_TIMESTAMP, 5) FROM t1 ORDER BY 1;
t1_TIMESTAMP	WEEK(t1_TIMESTAMP, 5)
1972-11-22 11:19:52	47
1997-11-21 01:00:50	46
SELECT t1_TIMESTAMP, WEEK(t1_TIMESTAMP, 6) FROM t1 ORDER BY 1;
t1_TIMESTAMP	WEEK(t1_TIMESTAMP, 6)
1972-11-22 11:19:52	47
1997-11-21 01:00:50	47
SELECT t1_TIMESTAMP, WEEK(t1_TIMESTAMP, 7) FROM t1 ORDER BY 1;
t1_TIMESTAMP	WEEK(t1_TIMESTAMP, 7)
1972-11-22 11:19:52	47
1997-11-21 01:00:50	46
DROP DATABASE week_function;
