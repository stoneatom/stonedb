#
# TIMESTAMPDIFF() function
# Author: syw
#
DROP DATABASE IF EXISTS timestampdiff_function;
CREATE DATABASE timestampdiff_function;
USE timestampdiff_function;
CREATE TABLE t1
(
t1_DATE DATE,
t1_TIMESTAMP TIMESTAMP,
t1_DATETIME DATETIME
)ENGINE=tianmu;
INSERT INTO t1 VALUES('1991-05-30', '1999-10-28 01:00:50', '09-12-11 01:08:59');
SELECT TIMESTAMPDIFF(MICROSECOND, '2011-3-4 3:12:11.123', '2011-3-4 3:12:11.111') FROM t1 LIMIT 1;
TIMESTAMPDIFF(MICROSECOND, '2011-3-4 3:12:11.123', '2011-3-4 3:12:11.111')
-12000
SELECT TIMESTAMPDIFF(SECOND, '2012-3-3 1:12:22', '2013-3-4 3:12:18') FROM t1 LIMIT 1;
TIMESTAMPDIFF(SECOND, '2012-3-3 1:12:22', '2013-3-4 3:12:18')
31629596
SELECT TIMESTAMPDIFF(MINUTE, '2012-3-3 1:12:22', '2013-3-4 3:12:18') FROM t1 LIMIT 1;
TIMESTAMPDIFF(MINUTE, '2012-3-3 1:12:22', '2013-3-4 3:12:18')
527159
SELECT TIMESTAMPDIFF(HOUR, '2012-3-3 1:12:22', '2013-3-4 3:12:11') FROM t1 LIMIT 1;
TIMESTAMPDIFF(HOUR, '2012-3-3 1:12:22', '2013-3-4 3:12:11')
8785
SELECT TIMESTAMPDIFF(DAY, '2012-3-3 1:12:22', '2013-3-4 3:12:11') FROM t1 LIMIT 1;
TIMESTAMPDIFF(DAY, '2012-3-3 1:12:22', '2013-3-4 3:12:11')
366
SELECT TIMESTAMPDIFF(WEEK, '2012-3-3 1:12:22', '2013-3-4 3:12:11') FROM t1 LIMIT 1;
TIMESTAMPDIFF(WEEK, '2012-3-3 1:12:22', '2013-3-4 3:12:11')
52
SELECT TIMESTAMPDIFF(MONTH, '2012-3-3 1:12:22', '2013-3-4 3:12:11') FROM t1 LIMIT 1;
TIMESTAMPDIFF(MONTH, '2012-3-3 1:12:22', '2013-3-4 3:12:11')
12
SELECT TIMESTAMPDIFF(QUARTER, '2012-3-3 1:12:22', '2013-3-4 3:12:11') FROM t1 LIMIT 1;
TIMESTAMPDIFF(QUARTER, '2012-3-3 1:12:22', '2013-3-4 3:12:11')
4
SELECT TIMESTAMPDIFF(YEAR, '2012-3-3 1:12:22', '2013-3-4 3:12:11') FROM t1 LIMIT 1;
TIMESTAMPDIFF(YEAR, '2012-3-3 1:12:22', '2013-3-4 3:12:11')
1
SELECT t1_DATE, TIMESTAMPDIFF(MICROSECOND, t1_DATE, '1991-05-30 00:00:00') FROM t1 ORDER BY 1;
t1_DATE	TIMESTAMPDIFF(MICROSECOND, t1_DATE, '1991-05-30 00:00:00')
1991-05-30	0
SELECT t1_DATE, TIMESTAMPDIFF(SECOND, t1_DATE, '1991-05-30 00:00:55') FROM t1 ORDER BY 1;
t1_DATE	TIMESTAMPDIFF(SECOND, t1_DATE, '1991-05-30 00:00:55')
1991-05-30	55
SELECT t1_DATE, TIMESTAMPDIFF(MINUTE, t1_DATE, '1991-05-30 00:42:55') FROM t1 ORDER BY 1;
t1_DATE	TIMESTAMPDIFF(MINUTE, t1_DATE, '1991-05-30 00:42:55')
1991-05-30	42
SELECT t1_DATE, TIMESTAMPDIFF(HOUR, t1_DATE, '1991-05-30 21:12:55') FROM t1 ORDER BY 1;
t1_DATE	TIMESTAMPDIFF(HOUR, t1_DATE, '1991-05-30 21:12:55')
1991-05-30	21
SELECT t1_DATE, TIMESTAMPDIFF(DAY, t1_DATE, '1991-05-31 1:12:55') FROM t1 ORDER BY 1;
t1_DATE	TIMESTAMPDIFF(DAY, t1_DATE, '1991-05-31 1:12:55')
1991-05-30	1
SELECT t1_DATE, TIMESTAMPDIFF(WEEK, t1_DATE, '1991-06-30 1:12:55') FROM t1 ORDER BY 1;
t1_DATE	TIMESTAMPDIFF(WEEK, t1_DATE, '1991-06-30 1:12:55')
1991-05-30	4
SELECT t1_DATE, TIMESTAMPDIFF(MONTH, t1_DATE, '1991-06-30 1:12:55') FROM t1 ORDER BY 1;
t1_DATE	TIMESTAMPDIFF(MONTH, t1_DATE, '1991-06-30 1:12:55')
1991-05-30	1
SELECT t1_DATE, TIMESTAMPDIFF(QUARTER, t1_DATE, '1991-11-30 1:12:55') FROM t1 ORDER BY 1;
t1_DATE	TIMESTAMPDIFF(QUARTER, t1_DATE, '1991-11-30 1:12:55')
1991-05-30	2
SELECT t1_DATE, TIMESTAMPDIFF(YEAR, t1_DATE, '1999-05-30 1:12:55') FROM t1 ORDER BY 1;
t1_DATE	TIMESTAMPDIFF(YEAR, t1_DATE, '1999-05-30 1:12:55')
1991-05-30	8
SELECT t1_TIMESTAMP, TIMESTAMPDIFF(MICROSECOND, t1_TIMESTAMP, '1999-10-28 01:00:51') FROM t1 ORDER BY 1;
t1_TIMESTAMP	TIMESTAMPDIFF(MICROSECOND, t1_TIMESTAMP, '1999-10-28 01:00:51')
1999-10-28 01:00:50	1000000
SELECT t1_TIMESTAMP, TIMESTAMPDIFF(SECOND, t1_TIMESTAMP, '1999-10-28 00:00:55') FROM t1 ORDER BY 1;
t1_TIMESTAMP	TIMESTAMPDIFF(SECOND, t1_TIMESTAMP, '1999-10-28 00:00:55')
1999-10-28 01:00:50	-3595
SELECT t1_TIMESTAMP, TIMESTAMPDIFF(MINUTE, t1_TIMESTAMP, '1999-10-28 00:42:55') FROM t1 ORDER BY 1;
t1_TIMESTAMP	TIMESTAMPDIFF(MINUTE, t1_TIMESTAMP, '1999-10-28 00:42:55')
1999-10-28 01:00:50	-17
SELECT t1_TIMESTAMP, TIMESTAMPDIFF(HOUR, t1_TIMESTAMP, '1999-10-28 21:12:55') FROM t1 ORDER BY 1;
t1_TIMESTAMP	TIMESTAMPDIFF(HOUR, t1_TIMESTAMP, '1999-10-28 21:12:55')
1999-10-28 01:00:50	20
SELECT t1_TIMESTAMP, TIMESTAMPDIFF(DAY, t1_TIMESTAMP, '1999-12-30 1:12:55') FROM t1 ORDER BY 1;
t1_TIMESTAMP	TIMESTAMPDIFF(DAY, t1_TIMESTAMP, '1999-12-30 1:12:55')
1999-10-28 01:00:50	63
SELECT t1_TIMESTAMP, TIMESTAMPDIFF(WEEK, t1_TIMESTAMP, '1999-06-30 1:12:55') FROM t1 ORDER BY 1;
t1_TIMESTAMP	TIMESTAMPDIFF(WEEK, t1_TIMESTAMP, '1999-06-30 1:12:55')
1999-10-28 01:00:50	-17
SELECT t1_TIMESTAMP, TIMESTAMPDIFF(MONTH, t1_TIMESTAMP, '1991-06-30 1:12:55') FROM t1 ORDER BY 1;
t1_TIMESTAMP	TIMESTAMPDIFF(MONTH, t1_TIMESTAMP, '1991-06-30 1:12:55')
1999-10-28 01:00:50	-99
SELECT t1_TIMESTAMP, TIMESTAMPDIFF(QUARTER, t1_TIMESTAMP, '1999-11-30 1:12:55') FROM t1 ORDER BY 1;
t1_TIMESTAMP	TIMESTAMPDIFF(QUARTER, t1_TIMESTAMP, '1999-11-30 1:12:55')
1999-10-28 01:00:50	0
SELECT t1_TIMESTAMP, TIMESTAMPDIFF(YEAR, t1_TIMESTAMP, '2999-05-30 1:12:55') FROM t1 ORDER BY 1;
t1_TIMESTAMP	TIMESTAMPDIFF(YEAR, t1_TIMESTAMP, '2999-05-30 1:12:55')
1999-10-28 01:00:50	999
SELECT t1_DATETIME, TIMESTAMPDIFF(MICROSECOND, t1_DATETIME, '09-12-11 01:09:59') FROM t1 ORDER BY 1;
t1_DATETIME	TIMESTAMPDIFF(MICROSECOND, t1_DATETIME, '09-12-11 01:09:59')
2009-12-11 01:08:59	60000000
SELECT t1_DATETIME, TIMESTAMPDIFF(SECOND, t1_DATETIME, '09-12-11 01:09:59') FROM t1 ORDER BY 1;
t1_DATETIME	TIMESTAMPDIFF(SECOND, t1_DATETIME, '09-12-11 01:09:59')
2009-12-11 01:08:59	60
SELECT t1_DATETIME, TIMESTAMPDIFF(MINUTE, t1_DATETIME, '09-12-11 01:09:59') FROM t1 ORDER BY 1;
t1_DATETIME	TIMESTAMPDIFF(MINUTE, t1_DATETIME, '09-12-11 01:09:59')
2009-12-11 01:08:59	1
SELECT t1_DATETIME, TIMESTAMPDIFF(HOUR, t1_DATETIME, '09-12-11 11:08:59') FROM t1 ORDER BY 1;
t1_DATETIME	TIMESTAMPDIFF(HOUR, t1_DATETIME, '09-12-11 11:08:59')
2009-12-11 01:08:59	10
SELECT t1_DATETIME, TIMESTAMPDIFF(DAY, t1_DATETIME, '09-12-1 01:08:59') FROM t1 ORDER BY 1;
t1_DATETIME	TIMESTAMPDIFF(DAY, t1_DATETIME, '09-12-1 01:08:59')
2009-12-11 01:08:59	-10
SELECT t1_DATETIME, TIMESTAMPDIFF(WEEK, t1_DATETIME, '09-11-11 01:08:59') FROM t1 ORDER BY 1;
t1_DATETIME	TIMESTAMPDIFF(WEEK, t1_DATETIME, '09-11-11 01:08:59')
2009-12-11 01:08:59	-4
SELECT t1_DATETIME, TIMESTAMPDIFF(MONTH, t1_DATETIME, '09-02-11 01:08:59') FROM t1 ORDER BY 1;
t1_DATETIME	TIMESTAMPDIFF(MONTH, t1_DATETIME, '09-02-11 01:08:59')
2009-12-11 01:08:59	-10
SELECT t1_DATETIME, TIMESTAMPDIFF(QUARTER, t1_DATETIME, '2009-02-11 01:08:59') FROM t1 ORDER BY 1;
t1_DATETIME	TIMESTAMPDIFF(QUARTER, t1_DATETIME, '2009-02-11 01:08:59')
2009-12-11 01:08:59	-3
SELECT t1_DATETIME, TIMESTAMPDIFF(YEAR, t1_DATETIME, '19-12-11 01:08:59') FROM t1 ORDER BY 1;
t1_DATETIME	TIMESTAMPDIFF(YEAR, t1_DATETIME, '19-12-11 01:08:59')
2009-12-11 01:08:59	10
DROP DATABASE timestampdiff_function;
