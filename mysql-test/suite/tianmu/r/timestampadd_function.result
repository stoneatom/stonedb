#
# TIMESTAMPADD() function
# Author: syw
#
DROP DATABASE IF EXISTS timestampadd_function;
CREATE DATABASE timestampadd_function;
USE timestampadd_function;
CREATE TABLE t1
(
t1_DATE DATE,
t1_TIMESTAMP TIMESTAMP,
t1_DATETIME DATETIME
)ENGINE=tianmu;
INSERT INTO t1 VALUES('1991-05-30', '1999-10-28 01:00:50', '09-12-11 01:08:59');
SELECT TIMESTAMPADD(MICROSECOND, 3, '2011-3-4 3:12:11.123') FROM t1 LIMIT 1;
TIMESTAMPADD(MICROSECOND, 3, '2011-3-4 3:12:11.123')
2011-03-04 03:12:11.123003
SELECT TIMESTAMPADD(SECOND, 3, '2012-3-3 1:12:22') FROM t1 LIMIT 1;
TIMESTAMPADD(SECOND, 3, '2012-3-3 1:12:22')
2012-03-03 01:12:25
SELECT TIMESTAMPADD(MINUTE, 3, '2012-3-3 1:12:22') FROM t1 LIMIT 1;
TIMESTAMPADD(MINUTE, 3, '2012-3-3 1:12:22')
2012-03-03 01:15:22
SELECT TIMESTAMPADD(HOUR, 3, '2012-3-3 1:12:22') FROM t1 LIMIT 1;
TIMESTAMPADD(HOUR, 3, '2012-3-3 1:12:22')
2012-03-03 04:12:22
SELECT TIMESTAMPADD(DAY, 3, '2012-3-3 1:12:22') FROM t1 LIMIT 1;
TIMESTAMPADD(DAY, 3, '2012-3-3 1:12:22')
2012-03-06 01:12:22
SELECT TIMESTAMPADD(WEEK, 3, '2012-3-3 1:12:22') FROM t1 LIMIT 1;
TIMESTAMPADD(WEEK, 3, '2012-3-3 1:12:22')
2012-03-24 01:12:22
SELECT TIMESTAMPADD(MONTH, 3, '2012-3-3 1:12:22') FROM t1 LIMIT 1;
TIMESTAMPADD(MONTH, 3, '2012-3-3 1:12:22')
2012-06-03 01:12:22
SELECT TIMESTAMPADD(QUARTER, 3, '2012-3-3 1:12:22') FROM t1 LIMIT 1;
TIMESTAMPADD(QUARTER, 3, '2012-3-3 1:12:22')
2012-12-03 01:12:22
SELECT TIMESTAMPADD(YEAR, 3, '2012-3-3 1:12:22') FROM t1 LIMIT 1;
TIMESTAMPADD(YEAR, 3, '2012-3-3 1:12:22')
2015-03-03 01:12:22
SELECT t1_DATE, TIMESTAMPADD(MICROSECOND, 3, t1_DATE) FROM t1 ORDER BY 1;
t1_DATE	TIMESTAMPADD(MICROSECOND, 3, t1_DATE)
1991-05-30	1991-05-30 00:00:00.000003
SELECT t1_DATE, TIMESTAMPADD(SECOND, 3, t1_DATE) FROM t1 ORDER BY 1;
t1_DATE	TIMESTAMPADD(SECOND, 3, t1_DATE)
1991-05-30	1991-05-30 00:00:03
SELECT t1_DATE, TIMESTAMPADD(MINUTE, 3, t1_DATE) FROM t1 ORDER BY 1;
t1_DATE	TIMESTAMPADD(MINUTE, 3, t1_DATE)
1991-05-30	1991-05-30 00:03:00
SELECT t1_DATE, TIMESTAMPADD(HOUR, 3, t1_DATE) FROM t1 ORDER BY 1;
t1_DATE	TIMESTAMPADD(HOUR, 3, t1_DATE)
1991-05-30	1991-05-30 03:00:00
SELECT t1_DATE, TIMESTAMPADD(DAY, 3, t1_DATE) FROM t1 ORDER BY 1;
t1_DATE	TIMESTAMPADD(DAY, 3, t1_DATE)
1991-05-30	1991-06-02
SELECT t1_DATE, TIMESTAMPADD(WEEK, 3, t1_DATE) FROM t1 ORDER BY 1;
t1_DATE	TIMESTAMPADD(WEEK, 3, t1_DATE)
1991-05-30	1991-06-20
SELECT t1_DATE, TIMESTAMPADD(MONTH, 3, t1_DATE) FROM t1 ORDER BY 1;
t1_DATE	TIMESTAMPADD(MONTH, 3, t1_DATE)
1991-05-30	1991-08-30
SELECT t1_DATE, TIMESTAMPADD(QUARTER, 3, t1_DATE) FROM t1 ORDER BY 1;
t1_DATE	TIMESTAMPADD(QUARTER, 3, t1_DATE)
1991-05-30	1992-02-29
SELECT t1_DATE, TIMESTAMPADD(YEAR, 3, t1_DATE) FROM t1 ORDER BY 1;
t1_DATE	TIMESTAMPADD(YEAR, 3, t1_DATE)
1991-05-30	1994-05-30
SELECT t1_TIMESTAMP, TIMESTAMPADD(MICROSECOND, 3, t1_TIMESTAMP) FROM t1 ORDER BY 1;
t1_TIMESTAMP	TIMESTAMPADD(MICROSECOND, 3, t1_TIMESTAMP)
1999-10-28 01:00:50	1999-10-28 01:00:50.000003
SELECT t1_TIMESTAMP, TIMESTAMPADD(SECOND, 3, t1_TIMESTAMP) FROM t1 ORDER BY 1;
t1_TIMESTAMP	TIMESTAMPADD(SECOND, 3, t1_TIMESTAMP)
1999-10-28 01:00:50	1999-10-28 01:00:53
SELECT t1_TIMESTAMP, TIMESTAMPADD(MINUTE, 3, t1_TIMESTAMP) FROM t1 ORDER BY 1;
t1_TIMESTAMP	TIMESTAMPADD(MINUTE, 3, t1_TIMESTAMP)
1999-10-28 01:00:50	1999-10-28 01:03:50
SELECT t1_TIMESTAMP, TIMESTAMPADD(HOUR, 3, t1_TIMESTAMP) FROM t1 ORDER BY 1;
t1_TIMESTAMP	TIMESTAMPADD(HOUR, 3, t1_TIMESTAMP)
1999-10-28 01:00:50	1999-10-28 04:00:50
SELECT t1_TIMESTAMP, TIMESTAMPADD(DAY, 3, t1_TIMESTAMP) FROM t1 ORDER BY 1;
t1_TIMESTAMP	TIMESTAMPADD(DAY, 3, t1_TIMESTAMP)
1999-10-28 01:00:50	1999-10-31 01:00:50
SELECT t1_TIMESTAMP, TIMESTAMPADD(WEEK, 3, t1_TIMESTAMP) FROM t1 ORDER BY 1;
t1_TIMESTAMP	TIMESTAMPADD(WEEK, 3, t1_TIMESTAMP)
1999-10-28 01:00:50	1999-11-18 01:00:50
SELECT t1_TIMESTAMP, TIMESTAMPADD(MONTH, 3, t1_TIMESTAMP) FROM t1 ORDER BY 1;
t1_TIMESTAMP	TIMESTAMPADD(MONTH, 3, t1_TIMESTAMP)
1999-10-28 01:00:50	2000-01-28 01:00:50
SELECT t1_TIMESTAMP, TIMESTAMPADD(QUARTER, 3, t1_TIMESTAMP) FROM t1 ORDER BY 1;
t1_TIMESTAMP	TIMESTAMPADD(QUARTER, 3, t1_TIMESTAMP)
1999-10-28 01:00:50	2000-07-28 01:00:50
SELECT t1_TIMESTAMP, TIMESTAMPADD(YEAR, 3, t1_TIMESTAMP) FROM t1 ORDER BY 1;
t1_TIMESTAMP	TIMESTAMPADD(YEAR, 3, t1_TIMESTAMP)
1999-10-28 01:00:50	2002-10-28 01:00:50
SELECT t1_DATETIME, TIMESTAMPADD(MICROSECOND, 3, t1_DATETIME) FROM t1 ORDER BY 1;
t1_DATETIME	TIMESTAMPADD(MICROSECOND, 3, t1_DATETIME)
2009-12-11 01:08:59	2009-12-11 01:08:59.000003
SELECT t1_DATETIME, TIMESTAMPADD(SECOND, 3, t1_DATETIME) FROM t1 ORDER BY 1;
t1_DATETIME	TIMESTAMPADD(SECOND, 3, t1_DATETIME)
2009-12-11 01:08:59	2009-12-11 01:09:02
SELECT t1_DATETIME, TIMESTAMPADD(MINUTE, 3, t1_DATETIME) FROM t1 ORDER BY 1;
t1_DATETIME	TIMESTAMPADD(MINUTE, 3, t1_DATETIME)
2009-12-11 01:08:59	2009-12-11 01:11:59
SELECT t1_DATETIME, TIMESTAMPADD(HOUR, 3, t1_DATETIME) FROM t1 ORDER BY 1;
t1_DATETIME	TIMESTAMPADD(HOUR, 3, t1_DATETIME)
2009-12-11 01:08:59	2009-12-11 04:08:59
SELECT t1_DATETIME, TIMESTAMPADD(DAY, 3, t1_DATETIME) FROM t1 ORDER BY 1;
t1_DATETIME	TIMESTAMPADD(DAY, 3, t1_DATETIME)
2009-12-11 01:08:59	2009-12-14 01:08:59
SELECT t1_DATETIME, TIMESTAMPADD(WEEK, 3, t1_DATETIME) FROM t1 ORDER BY 1;
t1_DATETIME	TIMESTAMPADD(WEEK, 3, t1_DATETIME)
2009-12-11 01:08:59	2010-01-01 01:08:59
SELECT t1_DATETIME, TIMESTAMPADD(MONTH, 3, t1_DATETIME) FROM t1 ORDER BY 1;
t1_DATETIME	TIMESTAMPADD(MONTH, 3, t1_DATETIME)
2009-12-11 01:08:59	2010-03-11 01:08:59
SELECT t1_DATETIME, TIMESTAMPADD(QUARTER, 3, t1_DATETIME) FROM t1 ORDER BY 1;
t1_DATETIME	TIMESTAMPADD(QUARTER, 3, t1_DATETIME)
2009-12-11 01:08:59	2010-09-11 01:08:59
SELECT t1_DATETIME, TIMESTAMPADD(YEAR, 3, t1_DATETIME) FROM t1 ORDER BY 1;
t1_DATETIME	TIMESTAMPADD(YEAR, 3, t1_DATETIME)
2009-12-11 01:08:59	2012-12-11 01:08:59
DROP DATABASE timestampadd_function;
