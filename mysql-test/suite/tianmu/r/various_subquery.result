#
# Test of various subqueries
#
DROP DATABASE IF EXISTS various_subquery_test;
CREATE DATABASE various_subquery_test;
USE various_subquery_test;
CREATE TABLE t1 (a int, b int);
INSERT INTO t1 values (1, 1), (2, 1), (3, 2), (4, 2), (5, 2);
SELECT "123" FROM (SELECT * FROM t1) q;
123
123
123
123
123
123
SELECT "123" FROM (SELECT "234" FROM t1) q;
123
123
123
123
123
123
SELECT a FROM (SELECT * FROM t1) q;
a
1
2
3
4
5
SELECT b FROM (SELECT * FROM t1) q;
b
1
1
2
2
2
SELECT a,b FROM (SELECT * FROM t1) q;
a	b
1	1
2	1
3	2
4	2
5	2
SELECT b,a FROM (SELECT * FROM t1) q;
b	a
1	1
1	2
2	3
2	4
2	5
SELECT a FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM t1) q1) q2) q3;
a
1
2
3
4
5
SELECT b FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM t1) q1) q2) q3;
b
1
1
2
2
2
SELECT a FROM (SELECT b,a FROM (SELECT * FROM t1) q1) q2;
a
1
2
3
4
5
SELECT b FROM (SELECT b,a FROM (SELECT * FROM t1) q1) q2;
b
1
1
2
2
2
SELECT "123" FROM (SELECT * FROM t1) q GROUP BY a ORDER BY a;
123
123
123
123
123
123
SELECT "123" FROM (SELECT * FROM t1) q GROUP BY b ORDER BY b;
123
123
123
SELECT "123" FROM (SELECT * FROM t1) q GROUP BY a,b ORDER BY a,b;
123
123
123
123
123
123
SELECT COUNT(a) FROM (SELECT * FROM t1) q GROUP BY a ORDER BY a;
COUNT(a)
1
1
1
1
1
SELECT COUNT(b) FROM (SELECT * FROM t1) q GROUP BY b ORDER BY b;
COUNT(b)
2
3
SELECT COUNT(a) FROM (SELECT * FROM t1) q GROUP BY b ORDER BY b;
COUNT(a)
2
3
SELECT COUNT(b) FROM (SELECT * FROM t1) q GROUP BY a ORDER BY a;
COUNT(b)
1
1
1
1
1
SELECT c1 FROM (SELECT a AS c1, COUNT(a) AS c2 FROM t1 GROUP BY c1) q ORDER BY c1;
c1
1
2
3
4
5
SELECT c2 FROM (SELECT a AS c1, COUNT(a) AS c2 FROM t1 GROUP BY c1) q ORDER BY c2;
c2
1
1
1
1
1
SELECT * FROM (SELECT a AS c1, COUNT(a) AS c2 FROM t1 GROUP BY c1) q ORDER BY c1,c2;
c1	c2
1	1
2	1
3	1
4	1
5	1
SELECT tab1.a FROM t1 tab1 JOIN (SELECT * FROM t1) tab2 ON tab1.a=tab2.a ORDER BY tab1.a;
a
1
2
3
4
5
SELECT tab1.a FROM t1 tab1 JOIN (SELECT * FROM t1) tab2 ON tab1.b=tab2.b ORDER BY tab1.a;
a
1
1
2
2
3
3
3
4
4
4
5
5
5
SELECT tab1.a FROM t1 tab1 JOIN (SELECT * FROM t1) tab2 ON tab1.b=tab2.b and tab1.a=tab2.a ORDER BY tab1.a;
a
1
2
3
4
5
SELECT tab1.a, tab2.b FROM t1 tab1 JOIN (SELECT * FROM t1) tab2 ON tab1.a=tab2.a ORDER BY tab1.a,tab2.b;
a	b
1	1
2	1
3	2
4	2
5	2
SELECT COUNT(a) FROM (SELECT * FROM t1 UNION ALL SELECT * FROM t1) q;
COUNT(a)
10
SELECT COUNT(b) FROM (SELECT * FROM t1 UNION ALL SELECT * FROM t1) q;
COUNT(b)
10
SELECT COUNT(b), COUNT(a) FROM (SELECT * FROM t1 UNION ALL SELECT * FROM t1) q;
COUNT(b)	COUNT(a)
10	10
SELECT COUNT(a) FROM (SELECT * FROM t1 UNION ALL SELECT * FROM t1) q GROUP BY b ORDER BY b;
COUNT(a)
4
6
SELECT q1.a FROM (SELECT * FROM (SELECT * FROM t1 UNION ALL SELECT * FROM t1) q1_1) q1 JOIN
(SELECT * FROM (SELECT * FROM t1 UNION ALL SELECT * FROM t1) q2_1) q2 ON q1.a=q2.a ORDER BY 1;
a
1
1
1
1
2
2
2
2
3
3
3
3
4
4
4
4
5
5
5
5
SELECT q1.a, q2.b FROM (SELECT * FROM (SELECT * FROM t1 UNION ALL SELECT * FROM t1) q1_1) q1 JOIN
(SELECT * FROM (SELECT * FROM t1 UNION ALL SELECT * FROM t1) q2_1) q2 ON q1.a=q2.a ORDER BY 2 desc, 1 asc;
a	b
3	2
3	2
3	2
3	2
4	2
4	2
4	2
4	2
5	2
5	2
5	2
5	2
1	1
1	1
1	1
1	1
2	1
2	1
2	1
2	1
SELECT "123" FROM (SELECT * FROM t1) q GROUP BY b ORDER BY b;
123
123
123
SELECT "123" FROM (SELECT * FROM t1) q GROUP BY b;
123
123
123
DROP DATABASE various_subquery_test;
